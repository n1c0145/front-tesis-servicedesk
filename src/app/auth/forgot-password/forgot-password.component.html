<div class="container">
  <mat-card class="card">
    <h1>Recuperar Contraseña</h1>

    <mat-horizontal-stepper [linear]="true" #stepper>

      <!-- Paso 1: correo -->
      <mat-step [stepControl]="emailForm">
        <form [formGroup]="emailForm">
          <ng-template matStepLabel>Ingresa tu correo</ng-template>
          <mat-form-field class="full-width" appearance="fill">
            <mat-label>Correo</mat-label>
            <input matInput placeholder="usuario&#64;dominio.com" formControlName="email">
            <mat-error *ngIf="emailForm.get('email')?.touched && emailForm.get('email')?.invalid">
              Ingresa un correo válido
            </mat-error>
          </mat-form-field>

          <button mat-raised-button color="primary" [disabled]="emailForm.invalid" (click)="save(stepper)">
            Siguiente
          </button>
        </form>
      </mat-step>

      <!-- Paso 2: código y nueva contraseña -->
      <mat-step [stepControl]="resetForm">
        <form [formGroup]="resetForm">
          <ng-template matStepLabel>Cambiar Contraseña</ng-template>

          <!-- Código de verificación -->
          <mat-form-field class="full-width" appearance="fill">
            <mat-label>Código de verificación</mat-label>
            <input matInput formControlName="codigo">
            <mat-error *ngIf="resetForm.get('codigo')?.touched && resetForm.get('codigo')?.invalid">
              Ingresa el código de verificación
            </mat-error>
          </mat-form-field>

          <!-- Nueva contraseña -->
          <mat-form-field class="full-width" appearance="fill">
            <mat-label>Contraseña</mat-label>
            <input matInput type="password" formControlName="password">
            <mat-error *ngIf="resetForm.get('password')?.touched">
              <div *ngIf="resetForm.get('password')?.errors?.['required']">Ingresa una contraseña</div>
              <div *ngIf="resetForm.get('password')?.errors?.['minlength']">Debe tener al menos 8 caracteres</div>
              <div *ngIf="resetForm.get('password')?.errors?.['uppercase']">Debe tener al menos una letra mayúscula
              </div>
              <div *ngIf="resetForm.get('password')?.errors?.['number']">Debe tener al menos un número</div>
              <div *ngIf="resetForm.get('password')?.errors?.['special']">Debe tener al menos un carácter especial</div>
            </mat-error>
          </mat-form-field>

          <!-- Repetir contraseña -->
          <mat-form-field class="full-width" appearance="fill">
            <mat-label>Repetir Contraseña</mat-label>
            <input matInput type="password" formControlName="repetirPassword">
            <mat-error *ngIf="resetForm.get('repetirPassword')?.touched">
              <div *ngIf="resetForm.get('repetirPassword')?.errors?.['required']">Repite la contraseña</div>
              <div *ngIf="resetForm.get('repetirPassword')?.errors?.['mismatch']">Las contraseñas no coinciden</div>
            </mat-error>
          </mat-form-field>

          <button mat-raised-button color="primary" [disabled]="resetForm.invalid" (click)="save2()">
            Cambiar Nueva Contraseña
          </button>
        </form>
      </mat-step>

    </mat-horizontal-stepper>

  </mat-card>
</div>